<html>
  <head>
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
  </head>
  <body>
    <a-scene>
      <a-assets>
        <img
          id="sky"
          src="https://cdn.glitch.com/11a604a1-b0f3-4dfe-ac39-15f8f6d86cad%2FGrid5-01.png?v=1602147573426"
          radius="10000"
        />
        <video
          id="vid"
          autoplay
          muted
          playsinline
          crossorigin="anonymous"
          loop="true"
          src="https://cdn.glitch.com/11a604a1-b0f3-4dfe-ac39-15f8f6d86cad%2Fdrippo.mp4?v=1602199128374"
        ></video>
        <a-asset-item
          id="human"
          src="https://cdn.glitch.com/11a604a1-b0f3-4dfe-ac39-15f8f6d86cad%2FFinalBaseMesh.obj?v=1602177368722"
        ></a-asset-item>

        <a-asset-item
          id="anzeige"
          src="https://cdn.glitch.com/11a604a1-b0f3-4dfe-ac39-15f8f6d86cad%2Fanzeigetafel.obj?v=1602202053698"
        ></a-asset-item>
      </a-assets>
      <a-box position="0 1 -1" src="#vid"></a-box>
      <a-entity
        obj-model="obj: https://cdn.glitch.com/11a604a1-b0f3-4dfe-ac39-15f8f6d86cad%2FFinalBaseMesh.obj?v=1602177368722"
        scale="0.1 0.1 0.1"
        rotation="0 90 0"
        position="1.88 0 -8.0"
      ></a-entity>

      <a-entity
        obj-model="obj: https://cdn.glitch.com/11a604a1-b0f3-4dfe-ac39-15f8f6d86cad%2FFinalBaseMesh.obj?v=1602177368722"
        scale="0.1 0.1 0.1"
        rotation="0 250.00000000000003 0"
        position="-2.15655 0 5.65156"
      ></a-entity>

      <a-entity
        obj-model="obj: https://cdn.glitch.com/11a604a1-b0f3-4dfe-ac39-15f8f6d86cad%2Fanzeigetafel.obj?v=1602202053698"
        scale="0.1 0.1 0.1"
        rotation="-90 180 0"
        position="1 6.9 11"
      ></a-entity>
      <a-entity
        obj-model="obj: https://cdn.glitch.com/11a604a1-b0f3-4dfe-ac39-15f8f6d86cad%2Fanzeigetafel.obj?v=1602202053698"
        scale="0.1 0.1 0.1"
        rotation="-90 0 0"
        position="-1 6.9 -11"
      ></a-entity>
      <a-sky src="#sky"></a-sky>

      <a-entity
        id="music"
        geometry="primitive: plane"
        material="color: blue"
        position="-10 0 0"
        sound="src: url(https://cdn.glitch.com/11a604a1-b0f3-4dfe-ac39-15f8f6d86cad%2F395107__dbbaker01__cabled-mess-deep-06-low-machine-ambience-paulstretched.wav?v=1602072057353); autoplay: true; loop: true; volume: 1.0"
      ></a-entity>

      <a-entity
        id="music2"
        geometry="primitive: plane"
        material="color: blue"
        position="-10 0 0"
        sound="src: url(https://cdn.glitch.com/11a604a1-b0f3-4dfe-ac39-15f8f6d86cad%2F93326__geraeusch__u-bahn-berlin-fahrt-ein-1.wav?v=1602175838836); autoplay: true; loop: true; volume: 2.5"
      ></a-entity>

      <a-text
        id="text-uhr"
        position="-0.25 2.784 -1.804"
        text="color: black; value: fucking timer"
      ></a-text>
    </a-scene>
    
    <script src="https://cdn.glitch.com/11a604a1-b0f3-4dfe-ac39-15f8f6d86cad%2Ftimer.js?v=1602204303041"></script>
  
  </body>
  <script>
    setTimeout(e => {
      document.getElementById("vid").play();
    }, 2000);
  </script>
  <script>
    let counter = 0 // Counter, wird nach pro Zeitintervall um 1 erhöht
const intervalMillis = 1000 // Intervall in Millisekunden, 1s = 1000ms
const minutesUntilTrainArrives = 1 // Wie viele Minuten soll es dauern bis der Timer aud 0 ist?

startTimer(counter)

function startTimer(counter){
    var remainingMinutes = minutesUntilTrainArrives // noch verbleibende Minuten

    var textElement = document.getElementById("text-uhr") // a-entity holen
    
    let time = padNumber(minutesUntilTrainArrives) + ":00"; // Text setzten

    var textAttribute = textElement.getAttribute("text"); // Das Text-Attribut ist ein JS Objekt

    textAttribute.value = time // Im "text"-Objekt ist der eigentliche Text im Feld "value" hinterlegt
    
    textElement.setAttribute("text", textAttribute)
    
     remainingMinutes-- // verbleibende Minuten um 1 reduzieren, da im nächsten durchlauf mit 59 weiter gemacht wird

    window.setInterval(function(){
        
        time = countdown(remainingMinutes, counter); 
        
        remainingMinutes = time[0] // Verbleibende Minuten aktualisieren
        
        
        textAttribute.value = time[1] // Text setzen 
        
        textElement.setAttribute("text", textAttribute) 
        
        counter = (counter + 1) % 61; // Stellt sicher dass counter zw. 0 und 60 liegt
        // Etwas seltsam, muss aber sein, da bei Counter = 60 s von Hand auf 59 gesetzt wird
        // Daher gäbe es, würde man den counter nicht wieder erhöhen s = 59 zweimal 
        // einmal wegen 59 - 60 = -1, was man braucht um die Minuten runterzuzählen aber auch die Zeit mm:00 zuzulassen
        // andererseits wegen 59 - 0 = 1
        if (counter == 0){
            counter++
        }
         
    },intervalMillis)
}
// Für einstellige Zahlen eine führende Null hinzufügen
function padNumber(number){
    stringNumber = number+""
    if (stringNumber.length < 2){
        stringNumber = "0"+stringNumber
    }
    return stringNumber 
}
//Eingabe: Die verbleibenden Minuten, die vergangenen Sekunden
//Ausgabe: 0: Die verbleibenden Minuten, 1: Die verbleibende Zeit inkl. führender Nullen falls einstellig
// Diese reduziert eine Zeitangabe in der Form mm:ss um eine Sekunde, bis 00:00 erreicht ist
function countdown(remainingMinutes, secondsPassed){
    s = (59-secondsPassed) // verbleibende Sekunden
    if(s == -1){ // Wenn s jetzt -1 ist war es vorher 0 => wir brauchen 59
        s = 59
        remainingMinutes = remainingMinutes -1 // Verbleibende Minuten um eins reduzieren
        if(remainingMinutes == -1){ // Wenn es jetzt -1 ist war es vorher 0 => Zeit Abgelaufen und neu starten
            remainingMinutes = minutesUntilTrainArrives-1 // -1 weil, weil s = 59 und daher statt zb 05:00 wäre dann 05:59, also falsch und ich keine Lust habe das jetzt vernnünftig zu machen :)
        }
    }

    return [remainingMinutes,padNumber(remainingMinutes) + ":" + padNumber(s)]

}
  </script>
  
</html>
